function OpenToast(n){$(document).Toasts("create",{title:"Thông báo",body:n,delay:5e3,autohide:!0,position:"bottomRight"})}function GetNotificationCount(){$.ajax({cache:!1,type:"GET",contentType:"application/json",dataType:"json",url:"/user/newnotificationscount",success:function(n){$("#user-notification-bell").text(n);n=="0"?$("#user-notification-bell").hide():$("#user-notification-bell").show()},error:function(){console.log("Get user notification count error.")}})}function UpdateDetailsOnChange(){var n=JSON.stringify({Note:$("#stock-user-note").val(),Symbol:$("#stock-details-symbol").val()});$.ajax({cache:!1,type:"POST",contentType:"application/json",dataType:"json",url:"/home/userstockdetailssave",data:n,success:function(n){console.log(n)},error:function(){console.log("Save details stock on close error")}})}function OpenModalDetails(n,t,i){var u=n,r;t!=""&&(u+=" ("+t+")");i==""?($("#remove-follow").hide(),$("#add-follow").hide()):i=="1"?($("#remove-follow").show(),$("#add-follow").hide()):($("#add-follow").show(),$("#remove-follow").hide());$("#follow-symbol").val(n);$("#stock-details-title").text("Chi tiết - "+u);r="/home/stockdetails?symbol="+n;$("#stock-details-body").html('<iframe src="'+r+'" class="embed-responsive-item" frameborder="0"><\/iframe>');$("#stock-details-link").prop("href",r);$("#stock-details-modal").modal("toggle")}function ToggleFollow(){var n=$("#follow-symbol").val();$.ajax({cache:!1,type:"GET",contentType:"application/json",dataType:"json",url:"/home/togglefollow?symbol="+n,success:function(n){n.status==1?OpenToast('<span class="text-success">'+n.message+"<\/span>"):OpenToast('<span class="text-danger">'+n.message+"<\/span>");$("#stock-details-modal").modal("toggle")},error:function(){console.log("ToggleFollow error")}})}var connection=(new signalR.HubConnectionBuilder).withUrl("/stockrealtime").build();connection.on("UpdateStockView",function(){LoadMarket()});connection.on("UpdateNotification",function(n){var t=$("#user-key").val();t==n&&GetNotificationCount()});$(function(){connection.start().then(function(){console.log("Realtime stock connected.")}).catch(function(n){return console.error(n.toString())});GetNotificationCount();$(document).on("click",".s-c",function(n){OpenModalDetails(n.target.innerText,n.target.attributes.title.nodeValue,n.target.attributes.fo.nodeValue)})});